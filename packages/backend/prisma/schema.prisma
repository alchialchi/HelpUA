datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum UILanguage {
  ENGLISH
  RUSSIAN
  UKRAINIAN
}

enum SpokenLanguage {
  ENGLISH
  RUSSIAN
  UKRAINIAN
  SWEDISH
  POLISH
  ROMANIAN
  GERMAN
}

enum Category {
  URGENT_CARE
  TRANSPORTATION
  LOCAL_INFORMATION
  ACCOMODATION
  MEDICAL_HELP
}

enum Role {
  HELPEE
  HELPER
}

model User {
  id             Int        @id @default(autoincrement())
  telegramUserId Int        @unique
  chatId         Int
  uiLanguage     UILanguage
  offers         Offer[]
}

model Offer {
  id        Int              @id @default(autoincrement())
  user      User             @relation(fields: [userId], references: [id])
  userId    Int
  category  Category
  languages SpokenLanguage[]
  role      Role
  helperMatches   Match[] @relation("Helper")
  helpeeMatches   Match[] @relation("Helpee")
}

model Match {
  id            Int   @id @default(autoincrement())
  helperOffer   Offer @relation("Helper", fields: [helperOfferId], references: [id])
  helperOfferId Int
  helpeeOffer   Offer @relation("Helpee", fields: [helpeeOfferId], references: [id])
  helpeeOfferId Int
}
